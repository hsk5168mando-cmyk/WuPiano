<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PianoWave - Neon Cyber Edition</title>
<style>
    /* 基礎樣式 */
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Segoe UI',sans-serif;color:#fff;background:#0a0a0a;} /* 背景調更深 */
    
    .hero{height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;background:linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1511376777868-611b54f68947?fit=crop&w=1950&q=80') center/cover no-repeat;text-align:center;}
    .hero h1{font-size:4rem;margin-bottom:20px;text-shadow:0 0 20px #ffcc00;}
    .hero p{font-size:1.5rem;margin-bottom:40px; color: #bbb;}
    .hero button{padding:15px 30px;font-size:1.2rem;border:none;border-radius:8px;cursor:pointer;background:#ffcc00;color:#111;font-weight:bold;box-shadow: 0 0 15px rgba(255, 204, 0, 0.4);}
    
    .section{padding:80px 20px;}
    .section h2{text-align:center;font-size:2.5rem;margin-bottom:40px; text-shadow: 0 0 10px rgba(255,255,255,0.5);}

    /* 樂理與貓咪的容器 */
    .theory-container {
        max-width: 1100px;
        margin: 0 auto;
        display: flex;
        align-items: flex-end; /* 讓貓咪看起來像坐在地板上 */
        justify-content: center;
        gap: 30px;
        flex-wrap: wrap;
    }

    /* 樂理小教室樣式 */
    .theory-grid {
        flex: 1;
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 25px;
        min-width: 300px;
    }
    .theory-card {
        background: rgba(255,255,255,0.03);
        padding: 25px;
        border-radius: 12px;
        border: 1px solid rgba(255, 204, 0, 0.1);
        border-left: 5px solid #ffcc00;
        line-height: 1.6;
        transition: 0.3s;
    }
    .theory-card:hover { transform: translateY(-5px); background: rgba(255,255,255,0.07); }
    .theory-card h3 { color: #ffcc00; margin-bottom: 12px; }
    .theory-card ul { margin-left: 20px; margin-top: 10px; font-size: 0.95rem; color: #ccc; }

    /* --- 程式寫的像素小貓咪樣式 --- */
    .pixel-cat {
        width: 80px;
        height: 80px;
        position: relative;
        flex-shrink: 0;
        margin-bottom: 10px;
    }

    /* 貓咪身體 */
    .cat-body {
        width: 60px;
        height: 45px;
        background: #333; /* 深灰色貓咪 */
        position: absolute;
        bottom: 0;
        left: 10px;
        border-radius: 20px 20px 5px 5px;
        animation: catBreath 3s ease-in-out infinite;
    }

    /* 貓咪頭部 */
    .cat-head {
        width: 45px;
        height: 35px;
        background: #333;
        position: absolute;
        bottom: 35px;
        left: 17.5px;
        border-radius: 12px 12px 8px 8px;
    }

    /* 貓耳朵 */
    .cat-head::before, .cat-head::after {
        content: '';
        position: absolute;
        top: -8px;
        width: 0; height: 0;
        border-left: 8px solid transparent;
        border-right: 8px solid transparent;
        border-bottom: 12px solid #333;
    }
    .cat-head::before { left: 2px; transform: rotate(-15deg); }
    .cat-head::after { right: 2px; transform: rotate(15deg); }

    /* 貓眼睛 (發出微微霓虹藍光) */
    .cat-eye {
        width: 6px;
        height: 6px;
        background: #00ffff;
        position: absolute;
        top: 12px;
        border-radius: 50%;
        box-shadow: 0 0 8px #00ffff;
        animation: catBlink 5s infinite;
    }
    .eye-l { left: 10px; }
    .eye-r { right: 10px; }

    /* 貓尾巴 */
    .cat-tail {
        width: 25px;
        height: 8px;
        background: #222;
        position: absolute;
        bottom: 5px;
        right: -10px;
        border-radius: 5px;
        transform-origin: left;
        animation: tailWag 2s ease-in-out infinite;
    }

    /* 小貓咪動畫 */
    @keyframes catBreath {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.03); }
    }
    @keyframes catBlink {
        0%, 90%, 100% { transform: scaleY(1); }
        95% { transform: scaleY(0.1); }
    }
    @keyframes tailWag {
        0%, 100% { transform: rotate(0deg); }
        50% { transform: rotate(25deg); }
    }

    /* --- 霓虹鋼琴區塊 --- */
    #piano-section {
        display: none;
        padding: 100px 20px;
        text-align: center;
        background: radial-gradient(circle at center, #1a0b2e 0%, #0a0a0a 100%);
        position: relative;
    }

    .piano-wrapper {
        display: inline-block;
        position: relative;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 15px;
        backdrop-filter: blur(10px);
    }

    .piano-wrapper::before {
        content: '';
        position: absolute;
        top: -2px; left: -2px; right: -2px; bottom: -2px;
        background: linear-gradient(45deg, #ff00ff, #00ffff, #ff00ff, #00ffff);
        background-size: 400%;
        z-index: -1;
        border-radius: 17px;
        animation: neonFlow 10s linear infinite;
        filter: blur(8px);
        opacity: 0.8;
    }

    @keyframes neonFlow {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .piano-scroll-container {
        width: 100%;
        overflow-x: auto;
        padding: 10px;
        touch-action: none; 
    }

    .piano-board {
        position: relative;
        height: 230px;
        background: #000;
        border-radius: 5px;
        user-select: none;
        box-shadow: inset 0 0 20px rgba(0,0,0,1);
    }

    .key {
        position: absolute;
        cursor: pointer;
        user-select: none;
        transition: transform 0.05s, background 0.05s, box-shadow 0.1s;
    }

    .white-key {
        width: 45px;
        height: 210px;
        background: linear-gradient(to bottom, #ddd 0%, #fff 100%);
        border: 1px solid #999;
        border-radius: 0 0 5px 5px;
        z-index: 1;
    }

    .white-key.active {
        background: #fff;
        transform: translateY(6px);
        box-shadow: 0 0 20px #ffcc00, inset 0 5px 10px rgba(0,0,0,0.2);
        z-index: 3;
    }

    .black-key {
        width: 28px;
        height: 130px;
        background: linear-gradient(180deg, #333 0%, #000 100%);
        border-radius: 0 0 4px 4px;
        z-index: 2;
        margin-left: -14px; 
        border: 1px solid #111;
        box-shadow: 2px 5px 10px rgba(0,0,0,0.5);
    }

    .black-key.active {
        background: #111;
        transform: translateY(4px);
        box-shadow: 0 0 20px #ff00ff, inset 0 2px 5px rgba(255,255,255,0.2);
        z-index: 4;
    }

    #piano-section p { margin-top: 30px; color: #888; font-size: 0.9rem; letter-spacing: 1px; }

</style>
</head>
<body>

<section class="hero">
    <h1>PianoWave</h1>
    <p>觸碰每一個音符，開啟你的音樂旅程</p>
    <button id="startBtn">立即演奏</button>
</section>

<section class="section">
    <h2>3 分鐘音樂小教室</h2>
    <div class="theory-container">
        <div class="theory-grid">
            <div class="theory-card">
                <h3>1. 聲音的樓梯（全音與半音）</h3>
                <p>想像鋼琴是一個樓梯：</p>
                <ul>
                    <li><strong>半音：</strong>就是「緊鄰」的下一個鍵。這是音樂中最小的距離。</li>
                    <li><strong>全音：</strong>跨過一個鍵的距離（中間隔了一個鍵）。</li>
                </ul>
            </div>
            <div class="theory-card">
                <h3>2. 什麼是和弦？（音樂組合餐）</h3>
                <p>同時按下去幾個音就像組合餐：</p>
                <ul>
                    <li><strong>三和弦：</strong>最常見的基礎組合，聽起來和諧穩定。例如C、E、G</li>
                    <li>不同的組合會創造快樂、憂傷或緊張的氛圍。</li>
                </ul>
            </div>
            <div class="theory-card">
                <h3>3. 鋼琴按鍵的規律</h3>
                <p>鋼琴是重複的循環：</p>
                <ul>
                    <li>黑鍵是 <strong>2 個、3 個</strong> 交替出現。</li>
                    <li><strong>2 個黑鍵左邊</strong> 的那個白鍵永遠是 <strong>C (Do)</strong>。</li>
                </ul>
            </div>
        </div>

        <div class="pixel-cat">
            <div class="cat-tail"></div>
            <div class="cat-body"></div>
            <div class="cat-head">
                <div class="cat-eye eye-l"></div>
                <div class="cat-eye eye-r"></div>
            </div>
        </div>
    </div>
</section>

<section id="piano-section">
    <h2 style="color: #00ffff; text-shadow: 0 0 15px #00ffff; margin-bottom: 40px;">Cyber Piano Station</h2>
    
    <div class="piano-wrapper">
        <div class="piano-scroll-container">
            <div id="pianoBoard" class="piano-board"></div>
        </div>
    </div>
    
    <p>TIP: 按住滑鼠或手指滑動可進行連續演奏 (Glissando)</p>
</section>

<script src="https://cdn.jsdelivr.net/npm/tone@14.8.49/build/Tone.min.js"></script>
<script>
    const pianoBoard = document.getElementById('pianoBoard');
    const startBtn = document.getElementById('startBtn');
    
    const whiteNotes = ['C', 'D', 'E', 'F', 'G', 'A', 'B'];
    const blackNotesMap = { 'C': 'C#', 'D': 'D#', 'F': 'F#', 'G': 'G#', 'A': 'A#' };
    const octaves = [2, 3, 4, 5]; 
    const whiteKeyWidth = 45;

    let sampler;
    let isMouseDown = false;

    window.addEventListener('mousedown', () => isMouseDown = true);
    window.addEventListener('mouseup', () => {
        isMouseDown = false;
        clearAllActive();
    });

    async function initSampler() {
        if (sampler) return;
        sampler = new Tone.Sampler({
            urls: {
                "C2": "C2.mp3", "C3": "C3.mp3", "C4": "C4.mp3", "C5": "C5.mp3",
                "A2": "A2.mp3", "A3": "A3.mp3", "A4": "A4.mp3", "A5": "A5.mp3"
            },
            release: 1,
            baseUrl: "https://tonejs.github.io/audio/salamander/"
        }).toDestination();
        await Tone.loaded();
    }

    function clearAllActive() {
        document.querySelectorAll('.key').forEach(k => k.classList.remove('active'));
    }

    function createKeyboard() {
        pianoBoard.innerHTML = '';
        let whiteKeyCount = 0;

        octaves.forEach(octave => {
            whiteNotes.forEach(noteName => {
                const note = noteName + octave;
                const wk = document.createElement('div');
                wk.className = 'key white-key';
                wk.dataset.note = note;
                wk.style.left = (whiteKeyCount * whiteKeyWidth) + 'px';
                bindEvents(wk, note);
                pianoBoard.appendChild(wk);

                if (blackNotesMap[noteName]) {
                    const bk = document.createElement('div');
                    bk.className = 'key black-key';
                    const bNote = blackNotesMap[noteName] + octave;
                    bk.dataset.note = bNote;
                    bk.style.left = ((whiteKeyCount + 1) * whiteKeyWidth) + 'px';
                    bindEvents(bk, bNote);
                    pianoBoard.appendChild(bk);
                }
                whiteKeyCount++;
            });
        });
        pianoBoard.style.width = (whiteKeyCount * whiteKeyWidth) + 'px';
    }

    function bindEvents(el, note) {
        const play = () => {
            if (sampler) {
                sampler.triggerAttackRelease(note, "2n");
                el.classList.add('active');
            }
        };
        const stop = () => el.classList.remove('active');

        el.addEventListener('mousedown', (e) => { e.preventDefault(); play(); });
        el.addEventListener('mouseenter', () => { if (isMouseDown) play(); });
        el.addEventListener('mouseleave', stop);
        el.addEventListener('touchstart', (e) => { e.preventDefault(); play(); });
        el.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const target = document.elementFromPoint(touch.clientX, touch.clientY);
            if (target && target.classList.contains('key')) {
                const newNote = target.dataset.note;
                if (!target.classList.contains('active')) {
                    clearAllActive();
                    sampler.triggerAttackRelease(newNote, "2n");
                    target.classList.add('active');
                }
            }
        });
        el.addEventListener('touchend', clearAllActive);
    }

    startBtn.onclick = async () => {
        startBtn.innerText = "Initializing Cyberware...";
        await Tone.start();
        await initSampler();
        createKeyboard();
        document.getElementById('piano-section').style.display = 'block';
        startBtn.innerText = "System Ready";
        document.getElementById('piano-section').scrollIntoView({ behavior: 'smooth' });
    };
</script>
</body>
</html>

